<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Location-scale regression | Liesel Tutorials</title>
  <meta name="description" content="Tutorial book for the Liesel probabilistic programming framework" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Location-scale regression | Liesel Tutorials" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://avatars.githubusercontent.com/u/53620082" />
  <meta property="og:description" content="Tutorial book for the Liesel probabilistic programming framework" />
  <meta name="github-repo" content="liesel-devs/liesel-tutorials" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Location-scale regression | Liesel Tutorials" />
  
  <meta name="twitter:description" content="Tutorial book for the Liesel probabilistic programming framework" />
  <meta name="twitter:image" content="https://avatars.githubusercontent.com/u/53620082" />

<meta name="author" content="Hannes Riebl, Paul Wiemann" />


<meta name="date" content="2022-07-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="linear-regression.html"/>
<link rel="next" href="gev-responses.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Liesel Tutorials</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#installation"><i class="fa fa-check"></i><b>1.1</b> Installation</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#further-reading"><i class="fa fa-check"></i><b>1.2</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>2</b> Linear regression</a>
<ul>
<li class="chapter" data-level="2.1" data-path="linear-regression.html"><a href="linear-regression.html#model-building-with-liesel"><i class="fa fa-check"></i><b>2.1</b> Model building with Liesel</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="linear-regression.html"><a href="linear-regression.html#probabilistic-graphical-models"><i class="fa fa-check"></i><b>2.1.1</b> Probabilistic graphical models</a></li>
<li class="chapter" data-level="2.1.2" data-path="linear-regression.html"><a href="linear-regression.html#generating-the-data"><i class="fa fa-check"></i><b>2.1.2</b> Generating the data</a></li>
<li class="chapter" data-level="2.1.3" data-path="linear-regression.html"><a href="linear-regression.html#building-the-model-graph"><i class="fa fa-check"></i><b>2.1.3</b> Building the model graph</a></li>
<li class="chapter" data-level="2.1.4" data-path="linear-regression.html"><a href="linear-regression.html#node-and-model-log-probabilities"><i class="fa fa-check"></i><b>2.1.4</b> Node and model log-probabilities</a></li>
<li class="chapter" data-level="2.1.5" data-path="linear-regression.html"><a href="linear-regression.html#pure-stateless-jax-functions"><i class="fa fa-check"></i><b>2.1.5</b> Pure, stateless JAX functions</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="linear-regression.html"><a href="linear-regression.html#mcmc-inference-with-goose"><i class="fa fa-check"></i><b>2.2</b> MCMC inference with Goose</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="linear-regression.html"><a href="linear-regression.html#using-a-gibbs-kernel"><i class="fa fa-check"></i><b>2.2.1</b> Using a Gibbs kernel</a></li>
<li class="chapter" data-level="2.2.2" data-path="linear-regression.html"><a href="linear-regression.html#parameter-transformations"><i class="fa fa-check"></i><b>2.2.2</b> Parameter transformations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="location-scale-regression.html"><a href="location-scale-regression.html"><i class="fa fa-check"></i><b>3</b> Location-scale regression</a></li>
<li class="chapter" data-level="4" data-path="gev-responses.html"><a href="gev-responses.html"><i class="fa fa-check"></i><b>4</b> GEV responses</a></li>
<li class="chapter" data-level="5" data-path="comparing-samplers.html"><a href="comparing-samplers.html"><i class="fa fa-check"></i><b>5</b> Comparing samplers</a>
<ul>
<li class="chapter" data-level="5.1" data-path="comparing-samplers.html"><a href="comparing-samplers.html#metropolis-in-gibbs"><i class="fa fa-check"></i><b>5.1</b> Metropolis-in-Gibbs</a></li>
<li class="chapter" data-level="5.2" data-path="comparing-samplers.html"><a href="comparing-samplers.html#nuts-sampler"><i class="fa fa-check"></i><b>5.2</b> NUTS sampler</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="reproducibility.html"><a href="reproducibility.html"><i class="fa fa-check"></i><b>6</b> Reproducibility</a>
<ul>
<li class="chapter" data-level="6.1" data-path="reproducibility.html"><a href="reproducibility.html#prng-seeding"><i class="fa fa-check"></i><b>6.1</b> PRNG seeding</a></li>
<li class="chapter" data-level="6.2" data-path="reproducibility.html"><a href="reproducibility.html#gpu-non-determinism"><i class="fa fa-check"></i><b>6.2</b> GPU non-determinism</a></li>
<li class="chapter" data-level="6.3" data-path="reproducibility.html"><a href="reproducibility.html#non-reproducibility-across-systems"><i class="fa fa-check"></i><b>6.3</b> Non-reproducibility across systems</a></li>
<li class="chapter" data-level="6.4" data-path="reproducibility.html"><a href="reproducibility.html#see-also"><i class="fa fa-check"></i><b>6.4</b> See also</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Liesel Tutorials</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="location-scale-regression" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Location-scale regression<a href="location-scale-regression.html#location-scale-regression" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This tutorial implements a Bayesian location-scale regression model within the Liesel framework.
In contrast to the standard linear model with constant variance, the location-scale model allows for heteroscedasticity such that both the mean of the response variable as well as its variance depend on (possibly) different covariates.</p>
<p>This tutorial assumes a linear relationship between the expected value of the response and the regressors, whereas a logarithmic link is chosen for the standard deviation.
More specifically, we choose the model</p>
<p><span class="math display">\[
\begin{aligned}
y_i \sim \mathcal{N}_{} \left( \mathbf{x}_i^T \boldsymbol{\beta}, \exp \left( \mathbf{ z}_i^T \boldsymbol{\gamma} \right)^2 \right)
\end{aligned}
\]</span>
in which the single observation are conditionally independent.</p>
<p>From the equation we see that <em>location</em> covariates are collected in the design matrix <span class="math inline">\(\mathbf{X}\)</span> and <em>scale</em> covariates are contained in the design matrix <span class="math inline">\(\mathbf{ Z}\)</span>. Both matrices can, but generally do not have to, share common regressors.
We refer to <span class="math inline">\(\boldsymbol{\beta}\)</span> as location parameter and to <span class="math inline">\(\boldsymbol{\gamma}\)</span> as scale parameter.</p>
<p>In this notebook, both design matrices only contain one intercept and one regressor column.
However, the model design naturally generalizes to any (reasonable) number of covariates.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb75-1"><a href="location-scale-regression.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> liesel.goose <span class="im">as</span> gs</span>
<span id="cb75-2"><a href="location-scale-regression.html#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> liesel.liesel <span class="im">as</span> lsl</span>
<span id="cb75-3"><a href="location-scale-regression.html#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb75-4"><a href="location-scale-regression.html#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb75-5"><a href="location-scale-regression.html#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb75-6"><a href="location-scale-regression.html#cb75-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-7"><a href="location-scale-regression.html#cb75-7" aria-hidden="true" tabindex="-1"></a>sns.set_theme(style<span class="op">=</span><span class="st">&quot;whitegrid&quot;</span>)</span></code></pre></div>
<p>First lets generate the data according to the model</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb76-1"><a href="location-scale-regression.html#cb76-1" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> np.random.default_rng(seed<span class="op">=</span><span class="dv">13</span>)</span>
<span id="cb76-2"><a href="location-scale-regression.html#cb76-2" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">500</span></span>
<span id="cb76-3"><a href="location-scale-regression.html#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="location-scale-regression.html#cb76-4" aria-hidden="true" tabindex="-1"></a>true_beta <span class="op">=</span> np.array([<span class="fl">1.0</span>, <span class="fl">3.0</span>])</span>
<span id="cb76-5"><a href="location-scale-regression.html#cb76-5" aria-hidden="true" tabindex="-1"></a>true_gamma <span class="op">=</span> np.array([<span class="fl">0.0</span>, <span class="fl">0.5</span>])</span>
<span id="cb76-6"><a href="location-scale-regression.html#cb76-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-7"><a href="location-scale-regression.html#cb76-7" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.column_stack([np.ones(n), rng.uniform(low<span class="op">=</span><span class="dv">0</span>, high<span class="op">=</span><span class="dv">5</span>, size<span class="op">=</span>n)])</span>
<span id="cb76-8"><a href="location-scale-regression.html#cb76-8" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> np.column_stack([np.ones(n), rng.normal(loc<span class="op">=</span><span class="dv">2</span>, scale<span class="op">=</span><span class="dv">1</span>, size<span class="op">=</span>n)])</span>
<span id="cb76-9"><a href="location-scale-regression.html#cb76-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-10"><a href="location-scale-regression.html#cb76-10" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.zeros(n)</span>
<span id="cb76-11"><a href="location-scale-regression.html#cb76-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(n):</span>
<span id="cb76-12"><a href="location-scale-regression.html#cb76-12" aria-hidden="true" tabindex="-1"></a>    mean <span class="op">=</span> np.dot(X[i], true_beta)</span>
<span id="cb76-13"><a href="location-scale-regression.html#cb76-13" aria-hidden="true" tabindex="-1"></a>    log_sd <span class="op">=</span> np.dot(Z[i], true_gamma)</span>
<span id="cb76-14"><a href="location-scale-regression.html#cb76-14" aria-hidden="true" tabindex="-1"></a>    y[i] <span class="op">=</span> rng.normal(loc<span class="op">=</span>mean, scale<span class="op">=</span>np.exp(log_sd))</span></code></pre></div>
<p>The simulated data displays a linear relationship between the response <span class="math inline">\(\mathbf{y}\)</span> and the covariate <span class="math inline">\(\mathbf{x}\)</span>.
The slope of the estimated regression line is close to the true <span class="math inline">\(\beta_1 = 3\)</span>.
The right plot shows the relationship between <span class="math inline">\(\mathbf{y}\)</span> and the scale covariate vector <span class="math inline">\(\mathbf{z}\)</span>.
Larger values of <span class="math inline">\(\mathbf{ z}\)</span> lead to a larger variance of the response.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb77-1"><a href="location-scale-regression.html#cb77-1" aria-hidden="true" tabindex="-1"></a>fig, (ax1, ax2) <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb77-2"><a href="location-scale-regression.html#cb77-2" aria-hidden="true" tabindex="-1"></a>sns.regplot(</span>
<span id="cb77-3"><a href="location-scale-regression.html#cb77-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>X[:, <span class="dv">1</span>],</span>
<span id="cb77-4"><a href="location-scale-regression.html#cb77-4" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>y,</span>
<span id="cb77-5"><a href="location-scale-regression.html#cb77-5" aria-hidden="true" tabindex="-1"></a>    fit_reg<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb77-6"><a href="location-scale-regression.html#cb77-6" aria-hidden="true" tabindex="-1"></a>    scatter_kws<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">&quot;grey&quot;</span>, s<span class="op">=</span><span class="dv">20</span>),</span>
<span id="cb77-7"><a href="location-scale-regression.html#cb77-7" aria-hidden="true" tabindex="-1"></a>    line_kws<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">&quot;blue&quot;</span>),</span>
<span id="cb77-8"><a href="location-scale-regression.html#cb77-8" aria-hidden="true" tabindex="-1"></a>    ax<span class="op">=</span>ax1,</span>
<span id="cb77-9"><a href="location-scale-regression.html#cb77-9" aria-hidden="true" tabindex="-1"></a>).<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">&quot;x&quot;</span>, ylabel<span class="op">=</span><span class="st">&quot;y&quot;</span>, xlim<span class="op">=</span>[<span class="op">-</span><span class="fl">0.2</span>, <span class="fl">5.2</span>])</span>
<span id="cb77-10"><a href="location-scale-regression.html#cb77-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-11"><a href="location-scale-regression.html#cb77-11" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(</span>
<span id="cb77-12"><a href="location-scale-regression.html#cb77-12" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>Z[:, <span class="dv">1</span>],</span>
<span id="cb77-13"><a href="location-scale-regression.html#cb77-13" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>y,</span>
<span id="cb77-14"><a href="location-scale-regression.html#cb77-14" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">&quot;grey&quot;</span>,</span>
<span id="cb77-15"><a href="location-scale-regression.html#cb77-15" aria-hidden="true" tabindex="-1"></a>    s<span class="op">=</span><span class="dv">40</span>,</span>
<span id="cb77-16"><a href="location-scale-regression.html#cb77-16" aria-hidden="true" tabindex="-1"></a>    ax<span class="op">=</span>ax2,</span>
<span id="cb77-17"><a href="location-scale-regression.html#cb77-17" aria-hidden="true" tabindex="-1"></a>).<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">&quot;z&quot;</span>, xlim<span class="op">=</span>[<span class="op">-</span><span class="dv">1</span>, <span class="fl">5.2</span>])</span>
<span id="cb77-18"><a href="location-scale-regression.html#cb77-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-19"><a href="location-scale-regression.html#cb77-19" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">&quot;Location-Scale Regression Model with Heteroscedastic Error&quot;</span>)</span>
<span id="cb77-20"><a href="location-scale-regression.html#cb77-20" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span>
<span id="cb77-21"><a href="location-scale-regression.html#cb77-21" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-38-15.png" width="1152" /></p>
<p>Since positivity of the variance is ensured by the exponential function, the linear part <span class="math inline">\(\mathbf{z}_i^T \boldsymbol{\gamma}\)</span> is not restricted to the positive real line.
Hence, setting a normal prior distribution for <span class="math inline">\(\gamma\)</span> is feasible, leading to an almost symmetric specification of the location and scale parts of the model.
The nodes <code>n_beta</code> and <code>n_gamma</code> are initialized with values far away from zero to support a stable sampling process:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb78-1"><a href="location-scale-regression.html#cb78-1" aria-hidden="true" tabindex="-1"></a>n_beta_loc <span class="op">=</span> lsl.Hyperparameter(value<span class="op">=</span><span class="fl">0.0</span>, name<span class="op">=</span><span class="st">&quot;beta_loc&quot;</span>)</span>
<span id="cb78-2"><a href="location-scale-regression.html#cb78-2" aria-hidden="true" tabindex="-1"></a>n_beta_scale <span class="op">=</span> lsl.Hyperparameter(value<span class="op">=</span><span class="fl">10.0</span>, name<span class="op">=</span><span class="st">&quot;beta_scale&quot;</span>)</span>
<span id="cb78-3"><a href="location-scale-regression.html#cb78-3" aria-hidden="true" tabindex="-1"></a>dist_beta <span class="op">=</span> lsl.NodeDistribution(</span>
<span id="cb78-4"><a href="location-scale-regression.html#cb78-4" aria-hidden="true" tabindex="-1"></a>    distribution<span class="op">=</span><span class="st">&quot;Normal&quot;</span>, loc<span class="op">=</span>n_beta_loc, scale<span class="op">=</span>n_beta_scale</span>
<span id="cb78-5"><a href="location-scale-regression.html#cb78-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb78-6"><a href="location-scale-regression.html#cb78-6" aria-hidden="true" tabindex="-1"></a>n_beta <span class="op">=</span> lsl.RegressionCoef(</span>
<span id="cb78-7"><a href="location-scale-regression.html#cb78-7" aria-hidden="true" tabindex="-1"></a>    value<span class="op">=</span>np.array([<span class="fl">10.0</span>, <span class="fl">10.0</span>]), distribution<span class="op">=</span>dist_beta, name<span class="op">=</span><span class="st">&quot;beta&quot;</span></span>
<span id="cb78-8"><a href="location-scale-regression.html#cb78-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb78-9"><a href="location-scale-regression.html#cb78-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-10"><a href="location-scale-regression.html#cb78-10" aria-hidden="true" tabindex="-1"></a>n_gamma_loc <span class="op">=</span> lsl.Hyperparameter(value<span class="op">=</span><span class="fl">0.0</span>, name<span class="op">=</span><span class="st">&quot;gamma_loc&quot;</span>)</span>
<span id="cb78-11"><a href="location-scale-regression.html#cb78-11" aria-hidden="true" tabindex="-1"></a>n_gamma_scale <span class="op">=</span> lsl.Hyperparameter(value<span class="op">=</span><span class="fl">3.0</span>, name<span class="op">=</span><span class="st">&quot;gamma_scale&quot;</span>)</span>
<span id="cb78-12"><a href="location-scale-regression.html#cb78-12" aria-hidden="true" tabindex="-1"></a>dist_gamma <span class="op">=</span> lsl.NodeDistribution(</span>
<span id="cb78-13"><a href="location-scale-regression.html#cb78-13" aria-hidden="true" tabindex="-1"></a>    distribution<span class="op">=</span><span class="st">&quot;Normal&quot;</span>, loc<span class="op">=</span>n_gamma_loc, scale<span class="op">=</span>n_gamma_scale</span>
<span id="cb78-14"><a href="location-scale-regression.html#cb78-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb78-15"><a href="location-scale-regression.html#cb78-15" aria-hidden="true" tabindex="-1"></a>n_gamma <span class="op">=</span> lsl.RegressionCoef(</span>
<span id="cb78-16"><a href="location-scale-regression.html#cb78-16" aria-hidden="true" tabindex="-1"></a>    value<span class="op">=</span>np.array([<span class="fl">5.0</span>, <span class="fl">5.0</span>]), distribution<span class="op">=</span>dist_gamma, name<span class="op">=</span><span class="st">&quot;gamma&quot;</span></span>
<span id="cb78-17"><a href="location-scale-regression.html#cb78-17" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>The additional complexity of the location-scale model compared to the standard linear model is handled in the next step.
Since <code>n_gamma</code> takes values on the whole real line, but the response node <code>n_y</code> expects a positive scale input, we transform the <code>Linear Smooth</code> node with a <code>Bijector</code> object, which is placed in between the linear predictor <code>n_scale_linear</code> and the response node <code>n_y</code>:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb79-1"><a href="location-scale-regression.html#cb79-1" aria-hidden="true" tabindex="-1"></a>n_X <span class="op">=</span> lsl.DesignMatrix(value<span class="op">=</span>X, name<span class="op">=</span><span class="st">&quot;X&quot;</span>)</span>
<span id="cb79-2"><a href="location-scale-regression.html#cb79-2" aria-hidden="true" tabindex="-1"></a>n_Z <span class="op">=</span> lsl.DesignMatrix(value<span class="op">=</span>Z, name<span class="op">=</span><span class="st">&quot;Z&quot;</span>)</span>
<span id="cb79-3"><a href="location-scale-regression.html#cb79-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-4"><a href="location-scale-regression.html#cb79-4" aria-hidden="true" tabindex="-1"></a>n_y_hat <span class="op">=</span> lsl.Smooth(n_X, n_beta, name<span class="op">=</span><span class="st">&quot;y_hat&quot;</span>)</span>
<span id="cb79-5"><a href="location-scale-regression.html#cb79-5" aria-hidden="true" tabindex="-1"></a>n_scale_linear <span class="op">=</span> lsl.Smooth(n_Z, n_gamma, name<span class="op">=</span><span class="st">&quot;scale_pred&quot;</span>)</span>
<span id="cb79-6"><a href="location-scale-regression.html#cb79-6" aria-hidden="true" tabindex="-1"></a>n_scale <span class="op">=</span> lsl.Bijector(bijector<span class="op">=</span><span class="st">&quot;Exp&quot;</span>, <span class="bu">input</span><span class="op">=</span>n_scale_linear, name<span class="op">=</span><span class="st">&quot;scale&quot;</span>)</span>
<span id="cb79-7"><a href="location-scale-regression.html#cb79-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-8"><a href="location-scale-regression.html#cb79-8" aria-hidden="true" tabindex="-1"></a>dist_y <span class="op">=</span> lsl.NodeDistribution(distribution<span class="op">=</span><span class="st">&quot;Normal&quot;</span>, loc<span class="op">=</span>n_y_hat, scale<span class="op">=</span>n_scale)</span>
<span id="cb79-9"><a href="location-scale-regression.html#cb79-9" aria-hidden="true" tabindex="-1"></a>n_y <span class="op">=</span> lsl.Response(value<span class="op">=</span>y, distribution<span class="op">=</span>dist_y, name<span class="op">=</span><span class="st">&quot;y&quot;</span>)</span></code></pre></div>
<p>We can now combine the nodes in a model and visulize it</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb80-1"><a href="location-scale-regression.html#cb80-1" aria-hidden="true" tabindex="-1"></a>sns.set_theme(style<span class="op">=</span><span class="st">&quot;white&quot;</span>)</span>
<span id="cb80-2"><a href="location-scale-regression.html#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="location-scale-regression.html#cb80-3" aria-hidden="true" tabindex="-1"></a>mb <span class="op">=</span> lsl.ModelBuilder()</span>
<span id="cb80-4"><a href="location-scale-regression.html#cb80-4" aria-hidden="true" tabindex="-1"></a>mb.add_nodes(n_y)</span></code></pre></div>
<pre><code>## ModelBuilder([Response(..., name=&#39;y&#39;), Smooth(..., name=&#39;y_hat&#39;), Bijector(..., name=&#39;scale&#39;), ...])</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb82-1"><a href="location-scale-regression.html#cb82-1" aria-hidden="true" tabindex="-1"></a>loc_scale_model <span class="op">=</span> mb.build()</span>
<span id="cb82-2"><a href="location-scale-regression.html#cb82-2" aria-hidden="true" tabindex="-1"></a>lsl.plot_model(model<span class="op">=</span>loc_scale_model, width<span class="op">=</span><span class="dv">12</span>, height<span class="op">=</span><span class="dv">8</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-41-17.png" width="1152" /></p>
<p>We choose the No U-Turn sampler for generating posterior samples.
Therefore the location and scale parameters can be drawn by separate NUTS kernels, or, if all remaining inputs to the kernel coincide, by one common kernel.
The latter option might lead to better estimation results but lacks the flexibility to e.g. choose different step sizes during the sampling process.</p>
<p>However, we will just fuse everything into one kernel do not use any specific arguments and hope that the default warmup scheme (similar to the warmup used in STAN) will do the trick.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb83-1"><a href="location-scale-regression.html#cb83-1" aria-hidden="true" tabindex="-1"></a>builder <span class="op">=</span> gs.EngineBuilder(seed<span class="op">=</span><span class="dv">3</span>, num_chains<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb83-2"><a href="location-scale-regression.html#cb83-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a href="location-scale-regression.html#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="co"># connects the engine with the model</span></span>
<span id="cb83-4"><a href="location-scale-regression.html#cb83-4" aria-hidden="true" tabindex="-1"></a>builder.set_model(lsl.GooseModel(loc_scale_model))</span>
<span id="cb83-5"><a href="location-scale-regression.html#cb83-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6"><a href="location-scale-regression.html#cb83-6" aria-hidden="true" tabindex="-1"></a><span class="co"># add the kernel</span></span>
<span id="cb83-7"><a href="location-scale-regression.html#cb83-7" aria-hidden="true" tabindex="-1"></a>builder.add_kernel(gs.NUTSKernel([<span class="st">&quot;beta&quot;</span>, <span class="st">&quot;gamma&quot;</span>]))</span>
<span id="cb83-8"><a href="location-scale-regression.html#cb83-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-9"><a href="location-scale-regression.html#cb83-9" aria-hidden="true" tabindex="-1"></a><span class="co"># set number of iterations in warmup and posterior</span></span>
<span id="cb83-10"><a href="location-scale-regression.html#cb83-10" aria-hidden="true" tabindex="-1"></a>builder.set_duration(warmup_duration<span class="op">=</span><span class="dv">1500</span>, posterior_duration<span class="op">=</span><span class="dv">1000</span>, term_duration<span class="op">=</span><span class="dv">500</span>)</span>
<span id="cb83-11"><a href="location-scale-regression.html#cb83-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-12"><a href="location-scale-regression.html#cb83-12" aria-hidden="true" tabindex="-1"></a><span class="co"># we use the same initial values for all chains</span></span>
<span id="cb83-13"><a href="location-scale-regression.html#cb83-13" aria-hidden="true" tabindex="-1"></a>builder.set_initial_values(loc_scale_model.state)</span>
<span id="cb83-14"><a href="location-scale-regression.html#cb83-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-15"><a href="location-scale-regression.html#cb83-15" aria-hidden="true" tabindex="-1"></a><span class="co"># create the engine</span></span>
<span id="cb83-16"><a href="location-scale-regression.html#cb83-16" aria-hidden="true" tabindex="-1"></a>engine <span class="op">=</span> builder.build()</span>
<span id="cb83-17"><a href="location-scale-regression.html#cb83-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-18"><a href="location-scale-regression.html#cb83-18" aria-hidden="true" tabindex="-1"></a><span class="co"># generate samples</span></span>
<span id="cb83-19"><a href="location-scale-regression.html#cb83-19" aria-hidden="true" tabindex="-1"></a>engine.sample_all_epochs()</span></code></pre></div>
<pre><code>## INFO - Starting epoch: FAST_ADAPTATION, 75 transitions, 25 jitted together
## WARNING - Errors per chain for kernel_00: 8, 7, 5, 11 / 75 transitions
## INFO - Finished epoch
## INFO - Starting epoch: SLOW_ADAPTATION, 25 transitions, 25 jitted together
## WARNING - Errors per chain for kernel_00: 1, 1, 1, 1 / 25 transitions
## INFO - Finished epoch
## INFO - Starting epoch: SLOW_ADAPTATION, 50 transitions, 25 jitted together
## WARNING - Errors per chain for kernel_00: 2, 4, 1, 2 / 50 transitions
## INFO - Finished epoch
## INFO - Starting epoch: SLOW_ADAPTATION, 100 transitions, 25 jitted together
## WARNING - Errors per chain for kernel_00: 4, 3, 2, 1 / 100 transitions
## INFO - Finished epoch
## INFO - Starting epoch: SLOW_ADAPTATION, 200 transitions, 25 jitted together
## WARNING - Errors per chain for kernel_00: 5, 5, 1, 3 / 200 transitions
## INFO - Finished epoch
## INFO - Starting epoch: SLOW_ADAPTATION, 550 transitions, 25 jitted together
## WARNING - Errors per chain for kernel_00: 4, 2, 6, 6 / 550 transitions
## INFO - Finished epoch
## INFO - Starting epoch: FAST_ADAPTATION, 500 transitions, 25 jitted together
## WARNING - Errors per chain for kernel_00: 4, 4, 3, 4 / 500 transitions
## INFO - Finished epoch
## INFO - Finished warmup
## INFO - Starting epoch: POSTERIOR, 1000 transitions, 25 jitted together
## INFO - Finished epoch</code></pre>
<p>Now that we have 1000 posterior samples per chain, we can check the results. Starting with the trace plots just using one chain.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb85-1"><a href="location-scale-regression.html#cb85-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> engine.get_results()</span>
<span id="cb85-2"><a href="location-scale-regression.html#cb85-2" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> gs.plot_trace(results, chain_indices<span class="op">=</span><span class="dv">0</span>, ncol<span class="op">=</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-43-19.png" width="1249" /></p>
<p>Looks decent although we can see some correlation in the tracplots especially for <span class="math inline">\(\beta\)</span>. Let’s check at the combined summary:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb86-1"><a href="location-scale-regression.html#cb86-1" aria-hidden="true" tabindex="-1"></a>gs.summary(results, per_chain<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="0" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>param_index</th>
      <th>num_samples</th>
      <th>num_effective</th>
      <th>mean</th>
      <th>sd</th>
      <th>rhat</th>
      <th>q_5</th>
      <th>q_50</th>
      <th>q_95</th>
      <th>hdi_90_low</th>
      <th>hdi_90_high</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>beta</th>
      <td>0</td>
      <td>4000</td>
      <td>1647.78</td>
      <td>0.831</td>
      <td>0.176</td>
      <td>1.003</td>
      <td>0.549</td>
      <td>0.83</td>
      <td>1.121</td>
      <td>0.555</td>
      <td>1.126</td>
    </tr>
    <tr>
      <th>beta</th>
      <td>1</td>
      <td>4000</td>
      <td>1731.873</td>
      <td>3.024</td>
      <td>0.059</td>
      <td>1.002</td>
      <td>2.927</td>
      <td>3.025</td>
      <td>3.12</td>
      <td>2.929</td>
      <td>3.121</td>
    </tr>
    <tr>
      <th>gamma</th>
      <td>0</td>
      <td>4000</td>
      <td>1812.388</td>
      <td>-0.138</td>
      <td>0.072</td>
      <td>1.003</td>
      <td>-0.253</td>
      <td>-0.142</td>
      <td>-0.018</td>
      <td>-0.259</td>
      <td>-0.025</td>
    </tr>
    <tr>
      <th>gamma</th>
      <td>1</td>
      <td>4000</td>
      <td>1847.944</td>
      <td>0.542</td>
      <td>0.032</td>
      <td>1.002</td>
      <td>0.489</td>
      <td>0.543</td>
      <td>0.595</td>
      <td>0.487</td>
      <td>0.593</td>
    </tr>
  </tbody>
</table>
</div>
<p>Maybe a longer warm-up would give us better samples.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb87-1"><a href="location-scale-regression.html#cb87-1" aria-hidden="true" tabindex="-1"></a>builder <span class="op">=</span> gs.EngineBuilder(seed<span class="op">=</span><span class="dv">3</span>, num_chains<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb87-2"><a href="location-scale-regression.html#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="location-scale-regression.html#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="co"># connects the engine with the model</span></span>
<span id="cb87-4"><a href="location-scale-regression.html#cb87-4" aria-hidden="true" tabindex="-1"></a>builder.set_model(lsl.GooseModel(loc_scale_model))</span>
<span id="cb87-5"><a href="location-scale-regression.html#cb87-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-6"><a href="location-scale-regression.html#cb87-6" aria-hidden="true" tabindex="-1"></a><span class="co"># add the kernel</span></span>
<span id="cb87-7"><a href="location-scale-regression.html#cb87-7" aria-hidden="true" tabindex="-1"></a>builder.add_kernel(gs.NUTSKernel([<span class="st">&quot;beta&quot;</span>, <span class="st">&quot;gamma&quot;</span>]))</span>
<span id="cb87-8"><a href="location-scale-regression.html#cb87-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-9"><a href="location-scale-regression.html#cb87-9" aria-hidden="true" tabindex="-1"></a><span class="co"># set number of iterations in warmup and posterior</span></span>
<span id="cb87-10"><a href="location-scale-regression.html#cb87-10" aria-hidden="true" tabindex="-1"></a>builder.set_duration(warmup_duration<span class="op">=</span><span class="dv">4000</span>, posterior_duration<span class="op">=</span><span class="dv">1000</span>, term_duration<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb87-11"><a href="location-scale-regression.html#cb87-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-12"><a href="location-scale-regression.html#cb87-12" aria-hidden="true" tabindex="-1"></a><span class="co"># we use the same initial values for all chains</span></span>
<span id="cb87-13"><a href="location-scale-regression.html#cb87-13" aria-hidden="true" tabindex="-1"></a>builder.set_initial_values(loc_scale_model.state)</span>
<span id="cb87-14"><a href="location-scale-regression.html#cb87-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-15"><a href="location-scale-regression.html#cb87-15" aria-hidden="true" tabindex="-1"></a><span class="co"># create the engine</span></span>
<span id="cb87-16"><a href="location-scale-regression.html#cb87-16" aria-hidden="true" tabindex="-1"></a>engine <span class="op">=</span> builder.build()</span>
<span id="cb87-17"><a href="location-scale-regression.html#cb87-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-18"><a href="location-scale-regression.html#cb87-18" aria-hidden="true" tabindex="-1"></a><span class="co"># generate samples</span></span>
<span id="cb87-19"><a href="location-scale-regression.html#cb87-19" aria-hidden="true" tabindex="-1"></a>engine.sample_all_epochs()</span></code></pre></div>
<pre><code>## INFO - Starting epoch: FAST_ADAPTATION, 75 transitions, 25 jitted together
## WARNING - Errors per chain for kernel_00: 8, 7, 5, 11 / 75 transitions
## INFO - Finished epoch
## INFO - Starting epoch: SLOW_ADAPTATION, 25 transitions, 25 jitted together
## WARNING - Errors per chain for kernel_00: 1, 1, 1, 1 / 25 transitions
## INFO - Finished epoch
## INFO - Starting epoch: SLOW_ADAPTATION, 50 transitions, 25 jitted together
## WARNING - Errors per chain for kernel_00: 2, 4, 1, 2 / 50 transitions
## INFO - Finished epoch
## INFO - Starting epoch: SLOW_ADAPTATION, 100 transitions, 25 jitted together
## WARNING - Errors per chain for kernel_00: 4, 3, 2, 1 / 100 transitions
## INFO - Finished epoch
## INFO - Starting epoch: SLOW_ADAPTATION, 200 transitions, 25 jitted together
## WARNING - Errors per chain for kernel_00: 5, 5, 1, 3 / 200 transitions
## INFO - Finished epoch
## INFO - Starting epoch: SLOW_ADAPTATION, 400 transitions, 25 jitted together
## WARNING - Errors per chain for kernel_00: 4, 2, 6, 6 / 400 transitions
## INFO - Finished epoch
## INFO - Starting epoch: SLOW_ADAPTATION, 2150 transitions, 25 jitted together
## WARNING - Errors per chain for kernel_00: 5, 8, 5, 2 / 2150 transitions
## INFO - Finished epoch
## INFO - Starting epoch: FAST_ADAPTATION, 1000 transitions, 25 jitted together
## WARNING - Errors per chain for kernel_00: 7, 4, 6, 6 / 1000 transitions
## INFO - Finished epoch
## INFO - Finished warmup
## INFO - Starting epoch: POSTERIOR, 1000 transitions, 25 jitted together
## INFO - Finished epoch</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb89-1"><a href="location-scale-regression.html#cb89-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> engine.get_results()</span>
<span id="cb89-2"><a href="location-scale-regression.html#cb89-2" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> gs.plot_trace(results, chain_indices<span class="op">=</span><span class="dv">0</span>, ncol<span class="op">=</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-46-21.png" width="1249" /></p>
<div class="sourceCode" id="cb90"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb90-1"><a href="location-scale-regression.html#cb90-1" aria-hidden="true" tabindex="-1"></a>gs.summary(results, per_chain<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="0" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>param_index</th>
      <th>num_samples</th>
      <th>num_effective</th>
      <th>mean</th>
      <th>sd</th>
      <th>rhat</th>
      <th>q_5</th>
      <th>q_50</th>
      <th>q_95</th>
      <th>hdi_90_low</th>
      <th>hdi_90_high</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>beta</th>
      <td>0</td>
      <td>4000</td>
      <td>1853.511</td>
      <td>0.83</td>
      <td>0.177</td>
      <td>1.004</td>
      <td>0.543</td>
      <td>0.833</td>
      <td>1.125</td>
      <td>0.525</td>
      <td>1.102</td>
    </tr>
    <tr>
      <th>beta</th>
      <td>1</td>
      <td>4000</td>
      <td>1825.758</td>
      <td>3.024</td>
      <td>0.059</td>
      <td>1.004</td>
      <td>2.925</td>
      <td>3.025</td>
      <td>3.119</td>
      <td>2.928</td>
      <td>3.12</td>
    </tr>
    <tr>
      <th>gamma</th>
      <td>0</td>
      <td>4000</td>
      <td>1969.058</td>
      <td>-0.136</td>
      <td>0.074</td>
      <td>1</td>
      <td>-0.259</td>
      <td>-0.136</td>
      <td>-0.017</td>
      <td>-0.261</td>
      <td>-0.02</td>
    </tr>
    <tr>
      <th>gamma</th>
      <td>1</td>
      <td>4000</td>
      <td>2039.625</td>
      <td>0.541</td>
      <td>0.033</td>
      <td>1</td>
      <td>0.488</td>
      <td>0.541</td>
      <td>0.596</td>
      <td>0.49</td>
      <td>0.598</td>
    </tr>
  </tbody>
</table>
</div>
<p>Not really 😭</p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="linear-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="gev-responses.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/liesel-devs/liesel-tutorials/edit/main/rmarkdown/03-ls-reg.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
